args =  Namespace(bptt=5000, checkpoint='tmp/models/lapfinal2.pt', completion_mode='latent_var_model', conditional_data='', cuda=True, debug_mode=False, dedup=False, emotion_special_processing=False, emotion_type='basic', fake_endings='', happy_endings='', infer_nw_ignore_token_type='non_content_set2', inference_nw_kl_num_samples=1, inference_nw_uniform_distribution=False, inference_temperature=1.0, inference_use_argmax=False, iwnll_num_samples=5, keywords='', latent_plot_typ='kw', log_interval=100, model='LSTM', new_decoder=False, new_posterior_batch_defn=True, new_posterior_batch_defn_notitle=False, num_sentences_cond=4, outf='generated.txt', pretrain_ae_mode=False, previous_word_prior_dedup=False, print_cond_data=False, rake_as_inference=False, rake_model=False, sad_endings='', sanity_check_title=False, sanity_check_title_joined=False, sanity_check_unconditional=False, seed=1111, sentence_dedup=False, sents=40, story_body='', task='test_eval', temperature=1.0, test_data='rocstory_plan_write/ROCStories_all_merge_tokenize.titlesepkeysepstory.test', top_p=0.0, true_endings='', use_argmax=False, use_emotion_supervision=False, vocab='tmp/vocabs/vocab.pkl', words=1000)
criterion =  CrossEntropyLoss()
[CORPUS]: Loading dictionary from provided path :  tmp/vocabs/vocab.pkl
[dictionary]: len(dictionary.word2idx) =  37905
*** skip_cnt =  0
*** not_found_cnt =  0
=========>>>> data : num batches  981
use_argmax =  False
[TITLE] datai =  ['<pad>', '<pad>', '<pad>', '<pad>', 'drained', 'battery', '<EOT>']
[TITLE] datai =  ['<pad>', '<pad>', '<pad>', '<pad>', 'wire', 'hangers', '<EOT>']
[TITLE] datai =  ['<pad>', '<pad>', '<pad>', '<pad>', 'pulled', 'over', '<EOT>']
[TITLE] datai =  ['<pad>', '<pad>', '<pad>', '<pad>', 'new', 'mailman', '<EOT>']
[TITLE] datai =  ['<pad>', '<pad>', '<pad>', 'death', 'with', 'honor', '<EOT>']
[TITLE] datai =  ['<pad>', '<pad>', '<pad>', '<pad>', 'cruise', 'ship', '<EOT>']
[TITLE] datai =  ['<pad>', '<pad>', 'first', 'day', 'of', 'lab', '<EOT>']
[TITLE] datai =  ['<pad>', '<pad>', '<pad>', '<pad>', 'cold', 'turkey', '<EOT>']
[TITLE] datai =  ['john', 'goes', 'to', 'the', 'store', '.', '<EOT>']
[TITLE] datai =  ['<pad>', '<pad>', '<pad>', 'the', 'hard', 'fall', '<EOT>']
global_ignore_tokens =  [0, 19, 15, 82, 179, 9, 117, 327, 118, 1739, 133, 1308, 10214, 14963, 852, 2197, 26486, 2052, 86, 241, 26, 1729, 51, 56, 346, 546, 27, 1543, 7219, 33, 393, 273, 9551, 35, 126, 400, 354, 3174, 412, 151, 932, 684, 3127, 281, 1037, 20, 18, 614, 144, 111, 54, 819, 47, 1433, 794, 1950, 52, 463, 31, 310, 23, 29, 183, 132, 1899, 345, 21, 1461, 173, 55, 95, 468, 78, 124, 102, 454, 2545, 61, 859, 254, 1354, 80, 2094, 6230, 30, 130, 99, 110, 168, 136, 36, 469, 81, 971, 260, 4392, 568, 930, 3093, 309, 177, 149, 950, 49, 416, 994, 714, 455, 754, 160, 2005, 456, 198, 2580, 473, 7292, 157, 1281, 57, 210, 240, 657, 186, 604, 18235, 14526, 134, 1116, 48, 5805, 624, 297]
ignore_type_tokens_lists[args.infer_nw_ignore_token_type] =  ['<pad>', '.', '</s>', ',', '!', '<EOT>', 'i', 'me', 'my', 'myself', 'we', 'our', 'ours', 'ourselves', 'you', 'your', 'yours', 'yourself', 'yourselves', 'he', 'him', 'his', 'himself', 'she', 'her', 'hers', 'herself', 'it', 'its', 'itself', 'they', 'them', 'their', 'theirs', 'themselves', 'what', 'which', 'who', 'whom', 'this', 'that', 'these', 'those', 'am', 'is', 'are', 'was', 'were', 'be', 'been', 'being', 'have', 'has', 'had', 'having', 'do', 'does', 'did', 'doing', 'a', 'an', 'the', 'and', 'but', 'if', 'or', 'because', 'as', 'until', 'while', 'of', 'at', 'by', 'for', 'with', 'about', 'against', 'between', 'into', 'through', 'during', 'before', 'after', 'above', 'below', 'to', 'from', 'up', 'down', 'in', 'out', 'on', 'off', 'over', 'under', 'again', 'further', 'then', 'once', 'here', 'there', 'when', 'where', 'why', 'how', 'all', 'any', 'both', 'each', 'few', 'more', 'most', 'other', 'some', 'such', 'no', 'nor', 'not', 'only', 'own', 'same', 'so', 'than', 'too', 'very', 's', 't', 'can', 'will', 'just', 'don', 'should', 'now']
[POSTERIOR] datai =  ['drained', 'battery', 'tom', 'let', 'friend', 'borrow', 'phone', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['drained', 'battery', 'friend', 'kept', 'using', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['drained', 'battery', 'kept', 'draining', 'battery', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['drained', 'battery', 'tom', 'got', 'back', 'way', 'later', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['drained', 'battery', 'phone', 'died', 'shortly', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['wire', 'hangers', 'jane', 'asked', 'boyfriend', 'buy', 'coat', 'hangers', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['wire', 'hangers', "n't", 'really', 'know', 'much', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['wire', 'hangers', 'decided', 'get', 'cheapest', 'wire', 'hangers', 'could', 'find', '<pad>', '<pad>']
[POSTERIOR] datai =  ['wire', 'hangers', 'jane', 'displeased', 'decision', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['wire', 'hangers', 'go', 'back', 'get', 'right', 'kind', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['pulled', 'tom', 'driving', 'work', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['pulled', 'got', 'pulled', 'cop', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['pulled', 'tom', 'asked', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['pulled', 'cop', 'mentioned', 'busted', 'tail', 'light', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['pulled', 'tom', 'agreed', 'fix', 'got', 'warning', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['new', 'mailman', 'jan', "'s", 'mailman', "n't", 'competent', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['new', 'mailman', 'jan', 'moved', 'got', 'new', 'mailman', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['new', 'mailman', 'jan', "'s", 'new', 'mailman', 'good', 'job', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['new', 'mailman', 'jan', 'pleased', 'tipped', 'new', 'mailman', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['new', 'mailman', 'new', 'mailman', 'happy', 'jan', 'customer', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['death', 'honor', 'anita', 'teaches', 'math', 'oaxaca', 'mexico', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['death', 'honor', 'teaching', 'conditions', 'poor', 'pay', 'low', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['death', 'honor', 'therefore', 'anita', 'joined', 'teachers', "'", 'protests', 'plaza', '<pad>', '<pad>']
[POSTERIOR] datai =  ['death', 'honor', 'police', 'showed', 'saturday', 'morning', 'dismantle', 'crowd', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['death', 'honor', 'fired', 'warning', 'shots', 'one', 'hit', 'annita', 'killed', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cruise', 'ship', 'magdalene', 'wanted', 'go', 'cruise', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cruise', 'ship', 'saved', 'money', 'job', 'two', 'years', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cruise', 'ship', 'picked', 'cruise', 'caribbean', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cruise', 'ship', 'spent', 'journey', 'mildly', 'seasick', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cruise', 'ship', 'magdalene', 'greatly', 'distressed', 'reaction', 'cruise', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['first', 'day', 'lab', 'lab', 'instructor', 'introduced', 'us', 'class', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['first', 'day', 'lab', 'went', 'today', "'s", 'lab', 'safety', 'rules', '<pad>', '<pad>']
[POSTERIOR] datai =  ['first', 'day', 'lab', 'began', 'work', 'finished', 'talking', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['first', 'day', 'lab', 'since', 'lab', 'straightforward', 'finished', 'within', 'hour', '<pad>', '<pad>']
[POSTERIOR] datai =  ['first', 'day', 'lab', 'experiment', 'went', 'well', 'calmly', 'drove', 'home', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cold', 'turkey', 'jim', 'heavy', 'smoker', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cold', 'turkey', 'tried', 'quitting', 'several', 'times', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cold', 'turkey', 'even', 'tried', 'gums', 'patches', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cold', 'turkey', 'jim', 'got', 'car', 'accident', 'one', 'day', 'new', 'outlook', 'life']
[POSTERIOR] datai =  ['cold', 'turkey', 'jim', 'quit', 'cold', 'turkey', 'next', 'day', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['john', 'goes', 'store', 'john', 'went', 'store', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['john', 'goes', 'store', 'john', 'wanted', 'buy', 'tomatoes', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['john', 'goes', 'store', 'looked', 'everywhere', 'tomatoes', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['john', 'goes', 'store', 'store', 'sold', 'fresh', 'tomatoes', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['john', 'goes', 'store', 'john', 'sad', 'went', 'another', 'store', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['hard', 'fall', 'kathie', 'fell', 'bicycle', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['hard', 'fall', 'bumped', 'head', 'pretty', 'hard', 'ground', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['hard', 'fall', 'kathie', 'stood', 'dazed', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['hard', 'fall', 'stranger', 'escorted', 'hospital', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['hard', 'fall', 'kathie', 'treated', 'mild', 'concussion', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'tom', 'let', 'his', 'friend', 'borrow', 'his', 'phone', '.', '</s>', 'the', 'friend', 'kept', 'using', 'it', '.', '</s>', 'he', 'kept', 'draining', 'the', 'battery', '.', '</s>', 'tom', 'got', 'it', 'back', 'way', 'later', '.', '</s>', 'the', 'phone', 'died', 'shortly', 'after', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'jane', 'asked', 'her', 'boyfriend', 'to', 'buy', 'some', 'coat', 'hangers', '.', '</s>', 'he', 'did', "n't", 'really', 'know', 'much', 'about', 'them', '.', '</s>', 'he', 'decided', 'to', 'get', 'the', 'cheapest', 'wire', 'hangers', 'he', 'could', 'find', '.', '</s>', 'jane', 'was', 'very', 'displeased', 'with', 'his', 'decision', '.', '</s>', 'she', 'had', 'to', 'go', 'back', 'and', 'get', 'the', 'right', 'kind', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'tom', 'was', 'driving', 'to', 'work', '.', '</s>', 'he', 'got', 'pulled', 'over', 'by', 'a', 'cop', '.', '</s>', 'tom', 'asked', 'why', '.', '</s>', 'the', 'cop', 'mentioned', 'a', 'busted', 'tail', 'light', '.', '</s>', 'tom', 'agreed', 'to', 'fix', 'it', 'and', 'only', 'got', 'a', 'warning', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'jan', "'s", 'mailman', 'was', "n't", 'very', 'competent', '.', '</s>', 'when', 'jan', 'moved', 'she', 'got', 'a', 'new', 'mailman', '.', '</s>', 'jan', "'s", 'new', 'mailman', 'was', 'very', 'good', 'at', 'her', 'job', '.', '</s>', 'jan', 'was', 'so', 'pleased', 'that', 'she', 'tipped', 'her', 'new', 'mailman', '.', '</s>', 'the', 'new', 'mailman', 'was', 'happy', 'to', 'have', 'jan', 'as', 'a', 'customer', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'anita', 'teaches', 'math', 'in', 'oaxaca', 'mexico', '.', '</s>', 'but', 'teaching', 'conditions', 'are', 'poor', 'and', 'her', 'pay', 'is', 'too', 'low', '.', '</s>', 'therefore', ',', 'anita', 'joined', 'the', 'teachers', "'", 'protests', 'in', 'the', 'plaza', '.', '</s>', 'the', 'police', 'showed', 'up', 'saturday', 'morning', 'to', 'dismantle', 'the', 'crowd', '.', '</s>', 'they', 'fired', 'warning', 'shots', ',', 'but', 'one', 'hit', 'annita', 'and', 'killed', 'her', '.', '<eos>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'magdalene', 'wanted', 'to', 'go', 'on', 'a', 'cruise', '.', '</s>', 'she', 'saved', 'up', 'money', 'at', 'her', 'job', 'for', 'two', 'years', '.', '</s>', 'she', 'picked', 'a', 'cruise', 'of', 'the', 'caribbean', '.', '</s>', 'she', 'spent', 'most', 'of', 'the', 'journey', 'mildly', 'seasick', '.', '</s>', 'magdalene', 'was', 'greatly', 'distressed', 'at', 'her', 'reaction', 'to', 'the', 'cruise', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'the', 'lab', 'instructor', 'introduced', 'us', 'to', 'the', 'class', '.', '</s>', 'he', 'went', 'over', 'today', "'s", 'lab', 'and', 'safety', 'rules', '.', '</s>', 'we', 'began', 'to', 'work', 'once', 'he', 'finished', 'talking', '.', '</s>', 'since', 'the', 'lab', 'was', 'straightforward', ',', 'i', 'finished', 'within', 'a', 'hour', '.', '</s>', 'the', 'experiment', 'went', 'well', 'and', 'i', 'calmly', 'drove', 'home', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'jim', 'was', 'a', 'heavy', 'smoker', '.', '</s>', 'he', 'had', 'tried', 'quitting', 'several', 'times', 'before', '.', '</s>', 'he', 'had', 'even', 'tried', 'gums', 'and', 'patches', '.', '</s>', 'jim', 'got', 'in', 'a', 'car', 'accident', 'one', 'day', 'and', 'had', 'a', 'new', 'outlook', 'on', 'life', '.', '</s>', 'jim', 'quit', 'cold', 'turkey', 'the', 'next', 'day', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'john', 'went', 'to', 'the', 'store', '.', '</s>', 'john', 'wanted', 'to', 'buy', 'tomatoes', '.', '</s>', 'he', 'looked', 'everywhere', 'for', 'the', 'tomatoes', '.', '</s>', 'the', 'store', 'was', 'sold', 'out', 'of', 'fresh', 'tomatoes', '.', '</s>', 'john', 'was', 'sad', ',', 'and', 'went', 'to', 'another', 'store', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'kathie', 'fell', 'from', 'her', 'bicycle', '.', '</s>', 'she', 'bumped', 'her', 'head', 'pretty', 'hard', 'on', 'the', 'ground', '.', '</s>', 'kathie', 'stood', 'up', 'dazed', '.', '</s>', 'a', 'stranger', 'escorted', 'her', 'to', 'a', 'hospital', '.', '</s>', 'kathie', 'was', 'treated', 'for', 'a', 'mild', 'concussion', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
EVAL: total_loss_cond =  tensor(132407.9531, device='cuda:0')  ||| total_loss_kl =  tensor(33271.8789, device='cuda:0')  || total_elbo =  tensor(165679.8281, device='cuda:0')
EVAL : loss_cond =  tensor(134.9724, device='cuda:0') loss_kl =  tensor(33.9163, device='cuda:0') loss (total_loss_sum/ total_valid_tokens_cnt) =  3.125729881219201 loss_elbo =  168.8887136850153 prior_loss_per_token =  0.0 loss_cond_per_token =  tensor(2.4467, device='cuda:0')
EVAL: total_valid_tokens_cnt =  530052
=========================================================================================
| test_eval | test loss  3.13 | test ppl    22.78 | test bpc    4.509
=========================================================================================
