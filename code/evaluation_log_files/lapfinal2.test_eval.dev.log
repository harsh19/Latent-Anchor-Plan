args =  Namespace(bptt=5000, checkpoint='tmp/models/lapfinal2.pt', completion_mode='latent_var_model', conditional_data='', cuda=True, debug_mode=False, dedup=False, emotion_special_processing=False, emotion_type='basic', fake_endings='', happy_endings='', infer_nw_ignore_token_type='non_content_set2', inference_nw_kl_num_samples=1, inference_nw_uniform_distribution=False, inference_temperature=1.0, inference_use_argmax=False, iwnll_num_samples=5, keywords='', latent_plot_typ='kw', log_interval=100, model='LSTM', new_decoder=False, new_posterior_batch_defn=True, new_posterior_batch_defn_notitle=False, num_sentences_cond=4, outf='generated.txt', pretrain_ae_mode=False, previous_word_prior_dedup=False, print_cond_data=False, rake_as_inference=False, rake_model=False, sad_endings='', sanity_check_title=False, sanity_check_title_joined=False, sanity_check_unconditional=False, seed=1111, sentence_dedup=False, sents=40, story_body='', task='test_eval', temperature=1.0, test_data='rocstory_plan_write/ROCStories_all_merge_tokenize.titlesepkeysepstory.dev', top_p=0.0, true_endings='', use_argmax=False, use_emotion_supervision=False, vocab='tmp/vocabs/vocab.pkl', words=1000)
criterion =  CrossEntropyLoss()
[CORPUS]: Loading dictionary from provided path :  tmp/vocabs/vocab.pkl
[dictionary]: len(dictionary.word2idx) =  37905
*** skip_cnt =  0
*** not_found_cnt =  0
=========>>>> data : num batches  981
use_argmax =  False
[TITLE] datai =  ['the', 'pet', 'bug', '<EOT>']
[TITLE] datai =  ['<pad>', 'big', 'break', '<EOT>']
[TITLE] datai =  ['<pad>', '<pad>', 'roads', '<EOT>']
[TITLE] datai =  ['third', 'person', 'daphne', '<EOT>']
[TITLE] datai =  ['<pad>', 'judging', 'time', '<EOT>']
[TITLE] datai =  ['<pad>', 'the', 'cow', '<EOT>']
[TITLE] datai =  ['<pad>', 'jaunty', 'tune', '<EOT>']
[TITLE] datai =  ['color', 'does', 'matter', '<EOT>']
[TITLE] datai =  ['<pad>', '<pad>', 'chipmunks', '<EOT>']
[TITLE] datai =  ['<pad>', 'sun', 'glare', '<EOT>']
global_ignore_tokens =  [0, 19, 15, 82, 179, 9, 117, 327, 118, 1739, 133, 1308, 10214, 14963, 852, 2197, 26486, 2052, 86, 241, 26, 1729, 51, 56, 346, 546, 27, 1543, 7219, 33, 393, 273, 9551, 35, 126, 400, 354, 3174, 412, 151, 932, 684, 3127, 281, 1037, 20, 18, 614, 144, 111, 54, 819, 47, 1433, 794, 1950, 52, 463, 31, 310, 23, 29, 183, 132, 1899, 345, 21, 1461, 173, 55, 95, 468, 78, 124, 102, 454, 2545, 61, 859, 254, 1354, 80, 2094, 6230, 30, 130, 99, 110, 168, 136, 36, 469, 81, 971, 260, 4392, 568, 930, 3093, 309, 177, 149, 950, 49, 416, 994, 714, 455, 754, 160, 2005, 456, 198, 2580, 473, 7292, 157, 1281, 57, 210, 240, 657, 186, 604, 18235, 14526, 134, 1116, 48, 5805, 624, 297]
ignore_type_tokens_lists[args.infer_nw_ignore_token_type] =  ['<pad>', '.', '</s>', ',', '!', '<EOT>', 'i', 'me', 'my', 'myself', 'we', 'our', 'ours', 'ourselves', 'you', 'your', 'yours', 'yourself', 'yourselves', 'he', 'him', 'his', 'himself', 'she', 'her', 'hers', 'herself', 'it', 'its', 'itself', 'they', 'them', 'their', 'theirs', 'themselves', 'what', 'which', 'who', 'whom', 'this', 'that', 'these', 'those', 'am', 'is', 'are', 'was', 'were', 'be', 'been', 'being', 'have', 'has', 'had', 'having', 'do', 'does', 'did', 'doing', 'a', 'an', 'the', 'and', 'but', 'if', 'or', 'because', 'as', 'until', 'while', 'of', 'at', 'by', 'for', 'with', 'about', 'against', 'between', 'into', 'through', 'during', 'before', 'after', 'above', 'below', 'to', 'from', 'up', 'down', 'in', 'out', 'on', 'off', 'over', 'under', 'again', 'further', 'then', 'once', 'here', 'there', 'when', 'where', 'why', 'how', 'all', 'any', 'both', 'each', 'few', 'more', 'most', 'other', 'some', 'such', 'no', 'nor', 'not', 'only', 'own', 'same', 'so', 'than', 'too', 'very', 's', 't', 'can', 'will', 'just', 'don', 'should', 'now']
[POSTERIOR] datai =  ['pet', 'bug', 'oliver', 'playing', 'yard', 'one', 'day', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['pet', 'bug', 'suddenly', 'spotted', 'cool', 'beetle', 'caught', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['pet', 'bug', 'put', 'beetle', 'jar', 'gave', 'name', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['pet', 'bug', 'hoped', 'keep', 'pet', 'forever', 'dad', 'said', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['pet', 'bug', 'taught', 'oliver', 'release', 'pet', 'could', 'safe', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['big', 'break', 'joey', 'dreams', 'singer', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['big', 'break', 'practiced', 'every', 'day', 'despite', 'neighbours', 'complaints', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['big', 'break', 'went', 'along', 'meet', 'greet', 'music', 'producer', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['big', 'break', 'joey', 'took', 'along', 'demo', 'cd', 'like', 'many', 'people', '<pad>']
[POSTERIOR] datai =  ['big', 'break', 'amazement', 'producer', 'loved', 'joey', 'wanted', 'take', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['roads', 'james', 'trying', 'get', 'license', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['roads', 'second', 'time', 'taking', 'test', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['roads', 'problem', 'parallel', 'parking', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['roads', 'time', 'parked', 'perfectly', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['roads', 'could', 'say', 'hello', 'roads', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['third', 'person', 'daphne', 'daphne', 'bad', 'habit', 'speaking', 'third', 'person', '<pad>', '<pad>']
[POSTERIOR] datai =  ['third', 'person', 'daphne', 'wanted', 'break', 'bad', 'habit', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['third', 'person', 'daphne', 'daphne', 'researched', 'different', 'ways', 'end', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['third', 'person', 'daphne', 'eventually', 'found', 'method', 'worked', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['third', 'person', 'daphne', 'daphne', 'longer', 'speaks', 'third', 'person', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['judging', 'time', 'announcer', 'called', 'fran', "'s", 'name', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['judging', 'time', 'walked', 'lamb', 'edna', 'small', 'arena', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['judging', 'time', 'edna', "'s", 'white', 'coat', 'looked', 'like', 'giant', 'cotton', 'ball']
[POSTERIOR] datai =  ['judging', 'time', 'fran', 'stopped', 'walking', 'allowing', 'judges', 'look', 'edna', '<pad>', '<pad>']
[POSTERIOR] datai =  ['judging', 'time', 'judges', 'handed', 'scorecards', 'fran', 'exited', 'arena', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cow', 'cow', 'left', 'barn', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cow', 'went', 'field', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cow', 'cows', 'field', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cow', 'cow', 'found', 'spot', 'grass', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['cow', 'cow', 'ate', 'grass', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['jaunty', 'tune', 'man', 'whistling', 'jaunty', 'tune', 'subway', 'car', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['jaunty', 'tune', 'woman', 'began', 'get', 'annoyed', 'jaunty', 'tune', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['jaunty', 'tune', 'demanded', 'stop', 'whistling', 'jaunty', 'tune', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['jaunty', 'tune', 'man', 'refused', 'grounds', 'law', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['jaunty', 'tune', 'woman', 'got', 'next', 'stop', 'cursing', 'jaunty', 'tune', '<pad>', '<pad>']
[POSTERIOR] datai =  ['color', 'matter', 'jerome', 'cab', 'driver', 'needed', 'real', 'career', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['color', 'matter', 'applied', 'job', 'real', 'estate', 'office', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['color', 'matter', 'time', 'buy', 'new', 'suit', 'jerome', 'picked', 'bright', 'red', 'suit']
[POSTERIOR] datai =  ['color', 'matter', 'friend', 'told', 'pick', 'business', 'blue', 'black', 'jerome', 'said', '<pad>']
[POSTERIOR] datai =  ['color', 'matter', 'three', 'days', 'interview', 'jerome', 'turned', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['chipmunks', 'harry', 'taking', 'walk', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['chipmunks', 'saw', 'squirrel', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['chipmunks', 'realized', "n't", 'squirrel', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['chipmunks', 'chipmunk', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['chipmunks', 'harry', 'walked', 'away', 'disliked', 'chipmunks', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['sun', 'glare', 'tom', 'going', 'store', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['sun', 'glare', 'wife', 'told', 'take', 'sunglasses', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['sun', 'glare', 'tom', "n't", 'listen', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['sun', 'glare', 'way', 'sun', 'glare', 'really', 'bad', '<pad>', '<pad>', '<pad>', '<pad>']
[POSTERIOR] datai =  ['sun', 'glare', 'admitted', 'wife', 'right', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'oliver', 'was', 'playing', 'in', 'his', 'yard', 'one', 'day', '.', '</s>', 'suddenly', 'he', 'spotted', 'a', 'very', 'cool', 'beetle', 'and', 'caught', 'it', '.', '</s>', 'he', 'put', 'the', 'beetle', 'in', 'a', 'jar', 'and', 'gave', 'him', 'a', 'name', '.', '</s>', 'he', 'hoped', 'to', 'keep', 'his', 'pet', 'forever', 'but', 'his', 'dad', 'said', 'no', '.', '</s>', 'he', 'taught', 'oliver', 'to', 'release', 'the', 'pet', 'so', 'he', 'could', 'be', 'safe', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'joey', 'had', 'dreams', 'of', 'being', 'a', 'singer', '.', '</s>', 'he', 'practiced', 'every', 'day', ',', 'despite', 'his', 'neighbours', 'complaints', '.', '</s>', 'he', 'once', 'went', 'along', 'to', 'a', 'meet', 'and', 'greet', 'with', 'a', 'music', 'producer', '.', '</s>', 'joey', 'took', 'along', 'a', 'demo', 'cd', 'like', 'many', 'other', 'people', 'there', '.', '</s>', 'to', 'his', 'amazement', ',', 'the', 'producer', 'loved', 'joey', 'and', 'wanted', 'to', 'take', 'him', 'on', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'james', 'was', 'trying', 'to', 'get', 'his', 'license', '.', '</s>', 'this', 'was', 'his', 'second', 'time', 'taking', 'the', 'test', '.', '</s>', 'his', 'problem', 'was', 'parallel', 'parking', '.', '</s>', 'this', 'time', 'he', 'parked', 'perfectly', '!', '</s>', 'he', 'could', 'now', 'say', 'hello', 'to', 'the', 'roads', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'daphne', 'had', 'a', 'bad', 'habit', 'of', 'speaking', 'in', 'third', 'person', '.', '</s>', 'she', 'wanted', 'to', 'break', 'this', 'bad', 'habit', '.', '</s>', 'daphne', 'researched', 'different', 'ways', 'to', 'end', 'it', '.', '</s>', 'she', 'eventually', 'found', 'a', 'method', 'worked', '.', '</s>', 'daphne', 'no', 'longer', 'speaks', 'in', 'third', 'person', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'the', 'announcer', 'called', 'out', 'fran', "'s", 'name', '.', '</s>', 'she', 'walked', 'her', 'lamb', ',', 'edna', ',', 'into', 'the', 'small', 'arena', '.', '</s>', 'edna', "'s", 'white', 'coat', 'looked', 'like', 'a', 'giant', 'cotton', 'ball', '.', '</s>', 'fran', 'stopped', 'walking', 'allowing', 'the', 'judges', 'to', 'look', 'over', 'edna', '.', '</s>', 'after', 'the', 'judges', 'handed', 'in', 'their', 'scorecards', ',', 'fran', 'exited', 'the', 'arena', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'the', 'cow', 'left', 'the', 'barn', '.', '</s>', 'it', 'went', 'out', 'to', 'the', 'field', '.', '</s>', 'the', 'other', 'cows', 'were', 'out', 'in', 'the', 'field', '.', '</s>', 'the', 'cow', 'found', 'a', 'spot', 'of', 'grass', '.', '</s>', 'the', 'cow', 'ate', 'the', 'grass', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'a', 'man', 'was', 'whistling', 'a', 'jaunty', 'tune', 'on', 'a', 'subway', 'car', '.', '</s>', 'a', 'woman', 'began', 'to', 'get', 'annoyed', 'by', 'the', 'jaunty', 'tune', '.', '</s>', 'she', 'demanded', 'that', 'he', 'stop', 'whistling', 'a', 'jaunty', 'tune', '.', '</s>', 'the', 'man', 'refused', 'on', 'the', 'grounds', 'that', 'there', 'was', 'no', 'law', 'against', 'it', '.', '</s>', 'the', 'woman', 'got', 'off', 'at', 'the', 'next', 'stop', ',', 'cursing', 'the', 'jaunty', 'tune', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'jerome', 'was', 'a', 'cab', 'driver', 'who', 'needed', 'a', 'real', 'career', '.', '</s>', 'he', 'applied', 'for', 'a', 'job', 'in', 'a', 'real', 'estate', 'office', '.', '</s>', 'it', 'was', 'time', 'to', 'buy', 'a', 'new', 'suit', 'and', 'jerome', 'picked', 'a', 'bright', 'red', 'suit', '.', '</s>', 'a', 'friend', 'told', 'him', 'to', 'pick', 'a', 'business', 'blue', 'or', 'black', 'but', 'jerome', 'said', 'no', '.', '</s>', 'three', 'days', 'after', 'the', 'interview', ',', 'jerome', 'was', 'turned', 'down', '.', '<eos>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'harry', 'was', 'taking', 'a', 'walk', '.', '</s>', 'he', 'saw', 'a', 'squirrel', '.', '</s>', 'then', 'he', 'realized', 'it', 'was', "n't", 'a', 'squirrel', '.', '</s>', 'it', 'was', 'a', 'chipmunk', '.', '</s>', 'harry', 'walked', 'away', 'because', 'he', 'disliked', 'chipmunks', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
[CONDITIONAL] datai =  ['<EOL>', '</s>', 'tom', 'was', 'going', 'to', 'the', 'store', '.', '</s>', 'his', 'wife', 'told', 'him', 'to', 'take', 'sunglasses', '.', '</s>', 'tom', 'did', "n't", 'listen', '.', '</s>', 'on', 'the', 'way', 'there', 'the', 'sun', 'glare', 'was', 'really', 'bad', '.', '</s>', 'he', 'admitted', 'to', 'his', 'wife', 'that', 'she', 'was', 'right', '.', '<eos>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>', '<pad>']
EVAL: total_loss_cond =  tensor(138923.6250, device='cuda:0')  ||| total_loss_kl =  tensor(34236.3398, device='cuda:0')  || total_elbo =  tensor(173160.1875, device='cuda:0')
EVAL : loss_cond =  tensor(141.6143, device='cuda:0') loss_kl =  tensor(34.8994, device='cuda:0') loss (total_loss_sum/ total_valid_tokens_cnt) =  3.2444625723006357 loss_elbo =  176.51395259938838 prior_loss_per_token =  0.0 loss_cond_per_token =  tensor(2.5392, device='cuda:0')
EVAL: total_valid_tokens_cnt =  533709
=========================================================================================
| test_eval | test loss  3.24 | test ppl    25.65 | test bpc    4.681
=========================================================================================
